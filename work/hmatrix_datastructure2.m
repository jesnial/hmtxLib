clear variables, close all
% vector
x = rand(16,1);

% matrix
A = cell(2,2);

A{1,1}.type = 'fullmatrix';
A{1,1}.m = 8;
A{1,1}.n = 8;
A{1,1}.M = rand(A{1,1}.m,A{1,1}.n);

A{1,2}.type = 'fullmatrix';
A{1,2}.m = 8;
A{1,2}.n = 8;
A{1,2}.M = rand(A{1,2}.m,A{1,2}.n);

A{2,1}.type = 'fullmatrix';
A{2,1}.m = 8;
A{2,1}.n = 8;
A{2,1}.M = rand(A{2,1}.m,A{2,1}.n);

A{2,2} = cell(2,2);

A{2,2}{1,1}.type = 'fullmatrix';
A{2,2}{1,1}.m = 4;
A{2,2}{1,1}.n = 4;
A{2,2}{1,1}.M = rand(A{2,2}{1,1}.m,A{2,2}{1,1}.n);
A{2,2}{1,2}.type = 'fullmatrix';
A{2,2}{1,2}.m = 4;
A{2,2}{1,2}.n = 4;
A{2,2}{1,2}.M = rand(A{2,2}{1,1}.m,A{2,2}{1,1}.n);
A{2,2}{2,1}.type = 'fullmatrix';
A{2,2}{2,1}.m = 4;
A{2,2}{2,1}.n = 4;
A{2,2}{2,1}.M = rand(A{2,2}{1,1}.m,A{2,2}{1,1}.n);

A{2,2}{2,2} = cell(2,2);
A{2,2}{2,2}{1,1}.type = 'fullmatrix';
A{2,2}{2,2}{1,1}.m = 2;
A{2,2}{2,2}{1,1}.n = 2;
A{2,2}{2,2}{1,1}.M = rand(A{2,2}{2,2}{1,1}.m,A{2,2}{2,2}{1,1}.n);
A{2,2}{2,2}{1,2}.type = 'fullmatrix';
A{2,2}{2,2}{1,2}.m = 2;
A{2,2}{2,2}{1,2}.n = 2;
A{2,2}{2,2}{1,2}.M = rand(A{2,2}{2,2}{1,1}.m,A{2,2}{2,2}{1,1}.n);
A{2,2}{2,2}{2,1}.type = 'fullmatrix';
A{2,2}{2,2}{2,1}.m = 2;
A{2,2}{2,2}{2,1}.n = 2;
A{2,2}{2,2}{2,1}.M = rand(A{2,2}{2,2}{1,1}.m,A{2,2}{2,2}{1,1}.n);
A{2,2}{2,2}{2,2}.type = 'fullmatrix';
A{2,2}{2,2}{2,2}.m = 2;
A{2,2}{2,2}{2,2}.n = 2;
A{2,2}{2,2}{2,2}.M = rand(A{2,2}{2,2}{1,1}.m,A{2,2}{2,2}{1,1}.n);




% assemble full matrix
Am = [A{1,1}.M A{1,2}.M; A{2,1}.M [A{2,2}{1,1}.M A{2,2}{1,2}.M; A{2,2}{2,1}.M [A{2,2}{2,2}{1,1}.M A{2,2}{2,2}{1,2}.M; A{2,2}{2,2}{2,1}.M A{2,2}{2,2}{2,2}.M]]];
tic
b = Am*x;
toc

tic
b2 = hmtx_Ax(A,x);
toc

